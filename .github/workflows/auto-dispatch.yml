name: Auto-Dispatch Pipeline Issues

on:
  issues:
    types: [opened, reopened]

# Only one dispatch at a time â€” rapid issue creation collapses into a single run
concurrency:
  group: auto-dispatch-pipeline
  cancel-in-progress: true

jobs:
  dispatch:
    if: contains(github.event.issue.labels.*.name, 'pipeline')
    runs-on: ubuntu-latest
    steps:
      # Brief pause so concurrent issue creations collapse via cancel-in-progress
      - name: Debounce
        run: sleep 10

      - name: Dispatch repo-assist scheduled mode
        env:
          GH_TOKEN: ${{ secrets.GH_AW_GITHUB_TOKEN }}
        run: |
          gh workflow run repo-assist.lock.yml \
            --repo ${{ github.repository }}
